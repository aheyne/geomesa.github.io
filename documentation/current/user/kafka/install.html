

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing GeoMesa Kafka &mdash; GeoMesa 1.3.2-SNAPSHOT Manuals</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme_custom.css" type="text/css" />
  

  

  
    <link rel="top" title="GeoMesa 1.3.2-SNAPSHOT Manuals" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GeoMesa
          

          
          </a>

          
            
            
              <div class="version">
                1.3.2-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GeoMesa</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Installing GeoMesa Kafka</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user/kafka/install.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-geomesa-kafka">
<h1>Installing GeoMesa Kafka<a class="headerlink" href="#installing-geomesa-kafka" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Using the <a class="reference external" href="http://kafka.apache.org/">Kafka</a> module requires Kafka 0.8, 0.9, or 0.10
and ZooKeeper 3.4.5 or better.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These instructions are identical for Kafka 0.8.x, 0.9.x, and 0.10.x.
The value of <tt class="docutils literal"><span class="pre">$KAFKAVERSION</span></tt> is &#8220;08&#8221; for Kafka 0.8.x, &#8220;09&#8221; for Kafka 0.9.x,
or &#8220;10&#8221; for Kafka 0.10.x.</p>
</div>
<div class="section" id="installing-from-the-binary-distribution">
<h2>Installing from the Binary Distribution<a class="headerlink" href="#installing-from-the-binary-distribution" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa Kafka artifacts are available for download or can be built from source.
The easiest way to get started is to download the most recent binary version
(<tt class="docutils literal"><span class="pre">$VERSION</span></tt> = 1.3.2-SNAPSHOT) matching the version of Kafka you are using:</p>
<ul class="simple">
<li>Kafka 0.8.x release: <a class="reference external" href="https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-08-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-08-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz">https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-08-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-08-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz</a></li>
<li>Kafka 0.9.x release: <a class="reference external" href="https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-09-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-09-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz">https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-09-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-09-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz</a></li>
<li>Kafka 0.10.x release: <a class="reference external" href="https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-10-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-10-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz">https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-10-dist_2.11/1.3.2-SNAPSHOT/geomesa-kafka-10-dist_2.11-1.3.2-SNAPSHOT-bin.tar.gz</a></li>
</ul>
<p>Extract it somewhere convenient:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># download and unpackage the most recent distribution for Kafka 0.9:</span>
<span class="nv">$ </span>wget https://repo.locationtech.org/content/repositories/geomesa-releases/org/locationtech/geomesa/geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-dist_2.11/<span class="nv">$VERSION</span>/geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-dist_2.11-<span class="nv">$VERSION</span>-bin.tar.gz
<span class="nv">$ </span>tar xzvf geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-dist_2.11-<span class="nv">$VERSION</span>-bin.tar.gz
<span class="nv">$ </span><span class="nb">cd </span>geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-dist_2.11-<span class="nv">$VERSION</span>
<span class="nv">$ </span>ls
bin/  conf/  dist/  docs/  examples/  lib/  LICENSE.txt
</pre></div>
</div>
</div>
<div class="section" id="building-from-source">
<span id="kafka-install-source"></span><h2>Building from Source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa Kafka may also be built from source. For more information refer to <a class="reference internal" href="../../developer/introduction.html#building-from-source"><em>Building from Source</em></a>
in the developer manual, or to the <tt class="docutils literal"><span class="pre">README.md</span></tt> file in the the source distribution.
The remainder of the instructions in this chapter assume the use of the binary GeoMesa distribution.</p>
<p>If you have built from source, the Kafka distributions are created in the
respective <tt class="docutils literal"><span class="pre">target</span></tt> directory of each module below:</p>
<blockquote>
<div><ul class="simple">
<li>Kafka 0.8.x: <tt class="docutils literal"><span class="pre">geomesa-kafka/geomesa-kafka-dist/geomesa-kafka-08-dist</span></tt></li>
<li>Kafka 0.9.x: <tt class="docutils literal"><span class="pre">geomesa-kafka/geomesa-kafka-dist/geomesa-kafka-09-dist</span></tt></li>
<li>Kafka 0.10.x: <tt class="docutils literal"><span class="pre">geomesa-kafka/geomesa-kafka-dist/geomesa-kafka-10-dist</span></tt></li>
</ul>
</div></blockquote>
<p>More information about developing with GeoMesa may be found in the <a class="reference internal" href="../../developer/index.html"><em>Developer Manual</em></a>.</p>
</div>
<div class="section" id="setting-up-the-kafka-command-line-tools">
<span id="setting-up-kafka-commandline"></span><h2>Setting up the Kafka Command Line Tools<a class="headerlink" href="#setting-up-the-kafka-command-line-tools" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa comes with a set of command line tools for managing Kafka features. In each Kafka distribution the
tools are located in <tt class="docutils literal"><span class="pre">geomesa-kafka-$KAFKAVERSION-dist_2.11-$VERSION-bin.tar.gz/bin/</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can configure environment variables and classpath settings in
<tt class="docutils literal"><span class="pre">geomesa-kafka-$KAFKAVERSION_2.11-$VERSION/bin/geomesa-env.sh</span></tt></p>
</div>
<p>In the <tt class="docutils literal"><span class="pre">geomesa-kafka-$KAFKAVERSION_2.11-$VERSION</span></tt> directory, run <tt class="docutils literal"><span class="pre">bin/geomesa-kafka</span> <span class="pre">configure</span></tt>
to set up the tools.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">### in geomesa-kafka-$KAFKAVERSION_2.11-$VERSION:</span>
<span class="nv">$ </span>bin/geomesa-kafka configure
Using GEOMESA_KAFKA_HOME as <span class="nb">set</span>: /path/to/geomesa-kafka-<span class="nv">$KAFKAVERSION_2</span>.11-<span class="nv">$VERSION</span>
Is this intentional? Y<span class="se">\n</span> y
Warning: GEOMESA_LIB already <span class="nb">set</span>, probably by a prior configuration.
Current value is /path/to/geomesa-kafka-<span class="nv">$KAFKAVERSION_2</span>.11-<span class="nv">$VERSION</span>/lib.

Is this intentional? Y<span class="se">\n</span> y

To persist the configuration please update your bashrc file to include:
<span class="nb">export </span><span class="nv">GEOMESA_KAFKA_HOME</span><span class="o">=</span>/path/to/geomesa-kafka-<span class="nv">$KAFKAVERSION_2</span>.11-<span class="nv">$VERSION</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="k">${</span><span class="nv">GEOMESA_KAFKA_HOME</span><span class="k">}</span>/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>Update and re-source your <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> file to include the <tt class="docutils literal"><span class="pre">$GEOMESA_KAFKA_HOME</span></tt> and <tt class="docutils literal"><span class="pre">$PATH</span></tt> updates.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please note that the <tt class="docutils literal"><span class="pre">$GEOMESA_KAFKA_HOME</span></tt> variable points to the location of the <tt class="docutils literal"><span class="pre">geomesa-kafka-$KAFKAVERSION_2.11-$VERSION</span></tt>
directory, not the main geomesa binary distribution directory.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">geomesa-kafka</span></tt> will read the <tt class="docutils literal"><span class="pre">$GEOMESA_EXTRA_CLASSPATHS</span></tt> environment variable to include any
additional jars or directories in the classpath. Use the <tt class="docutils literal"><span class="pre">geomesa-kafka</span> <span class="pre">classpath</span></tt> command in order to see what
JARs are being used.</p>
</div>
<p>Test the command that invokes the GeoMesa Tools:</p>
<div class="code highlight-python"><div class="highlight"><pre>$ geomesa-kafka
Using GEOMESA_KAFKA_HOME = /path/to/geomesa-kafka-$KAFKAVERSION_2.11-$VERSION
Usage: geomesa-kafka [command] [command options]
  Commands:
    convert         Convert files using GeoMesa&#39;s internal SFT converter framework
    create-schema   Create a feature definition in GeoMesa
    get-schema      Describe the attributes of a given feature in GeoMesa
    get-names       List GeoMesa features for a given zkPath
    help            Show help
    listen          Listen to a GeoMesa Kafka topic
    remove-schema   Remove a schema and associated features from GeoMesa
    version         GeoMesa Version
</pre></div>
</div>
</div>
<div class="section" id="installing-geomesa-kafka-in-geoserver">
<span id="install-kafka-geoserver"></span><h2>Installing GeoMesa Kafka in GeoServer<a class="headerlink" href="#installing-geomesa-kafka-in-geoserver" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The GeoMesa Kafka GeoServer plugin requires the use of GeoServer
2.9.1 and GeoTools 15.1.</p>
</div>
<p>As described in section <a class="reference internal" href="../architecture.html#geomesa-and-geoserver"><em>GeoMesa and GeoServer</em></a>, GeoMesa implements a
<a class="reference external" href="http://geotools.org/">GeoTools</a>-compatible data store. This makes it possible
to use GeoMesa Keafka as a data store in <a class="reference external" href="http://geoserver.org/">GeoServer</a>.
GeoServer&#8217;s web site includes <a class="reference external" href="http://docs.geoserver.org/stable/en/user/installation/index.html">installation instructions for GeoServer</a>.</p>
<p>After GeoServer is running, you will also need to install the WPS plugin to
your GeoServer instance. The GeoServer WPS Plugin must match the version of
GeoServer instance. The GeoServer website includes instructions for downloading
and installing <a class="reference external" href="http://docs.geoserver.org/stable/en/user/services/wps/install.html">the WPS plugin</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If using Tomcat as a web server, it will most likely be necessary to
pass some custom options:</p>
<div class="highlight-python"><div class="highlight"><pre>export CATALINA_OPTS=&quot;-Xmx8g -XX:MaxPermSize=512M -Duser.timezone=UTC \
-server -Djava.awt.headless=true&quot;
</pre></div>
</div>
<p class="last">The value of <tt class="docutils literal"><span class="pre">-Xmx</span></tt> should be as large as your system will permit; this
is especially important for the Kafka plugin. You
should also consider passing <tt class="docutils literal"><span class="pre">-DGEOWEBCACHE_CACHE_DIR=/tmp/$USER-gwc</span></tt>
and <tt class="docutils literal"><span class="pre">-DEPSG-HSQL.directory=/tmp/$USER-hsql</span></tt>
as well. Be sure to restart Tomcat for changes to take place.</p>
</div>
<p>To install GeoMesa&#8217;s GeoServer plugin we can use the script <tt class="docutils literal"><span class="pre">manage-geoserver-plugins.sh</span></tt> in <tt class="docutils literal"><span class="pre">bin</span></tt> directory
of the appropriate GeoMesa Kafka binary distribution (see <a class="reference internal" href="../download.html#versions-and-downloads"><em>Versions and Downloads</em></a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If $GEOSERVER_HOME is set, then the <tt class="docutils literal"><span class="pre">--lib-dir</span></tt> parameter is not needed.</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>bin/manage-geoserver-plugins.sh --lib-dir /path/to/geoserver/WEB-INF/lib/ --install
Collecting Installed Jars
Collecting geomesa-gs-plugin Jars

Please choose which modules to install
Multiple may be specified, eg: 1 4 10
Type <span class="s1">&#39;a&#39;</span> to specify all
--------------------------------------
0 | geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin_2.11-<span class="nv">$VERSION</span>

Module<span class="o">(</span>s<span class="o">)</span> to install: 0
0 | Installing geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz
Done
</pre></div>
</div>
<p>Alternatively, extract the contents of the appropriate plugin archive into the GeoServer
<tt class="docutils literal"><span class="pre">WEB-INF/lib</span></tt> directory. If you are using Tomcat:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tar -xzvf <span class="se">\</span>
  geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin/dist/gs-plugins/geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz <span class="se">\</span>
  -C /path/to/tomcat/webapps/geoserver/WEB-INF/lib/
</pre></div>
</div>
<p>If you are using GeoServer&#8217;s built in Jetty web server:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tar -xzvf <span class="se">\</span>
  geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin/dist/gs-plugins/geomesa-kafka-<span class="nv">$KAFKAVERSION</span>-gs-plugin_2.11-<span class="nv">$VERSION</span>-install.tar.gz <span class="se">\</span>
  -C /path/to/geoserver/webapps/geoserver/WEB-INF/lib/
</pre></div>
</div>
<p>This will install the JARs for the Kafka GeoServer plugin and most of its dependencies.
However, you will also need additional JARs for Kafka and Zookeeper that will
be specific to your installation that you will also need to copy to GeoServer&#8217;s
<tt class="docutils literal"><span class="pre">WEB-INF/lib</span></tt> directory. For example,you should use the JARs that match the version of
Kafka you are running.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">GeoMesa 1.3.2-SNAPSHOT depends on Scala 2.11, so you should make sure you use the
Kafka version built with Scala 2.11 as well (<tt class="docutils literal"><span class="pre">kafka_2.11_*</span></tt>) to avoid
compatibility issues.</p>
</div>
<p>Copy these additional dependencies (or the equivalents for your Kafka installation) to
your GeoServer <tt class="docutils literal"><span class="pre">WEB-INF/lib</span></tt> directory.</p>
<p>Kafka 0.8</p>
<blockquote>
<div><ul class="simple">
<li>kafka-clients-0.8.2.1.jar</li>
<li>kafka_2.11-0.8.2.1.jar</li>
<li>metrics-core-2.2.0.jar</li>
<li>zkclient-0.3.jar</li>
<li>zookeeper-3.4.6.jar</li>
</ul>
</div></blockquote>
<p>Kafka 0.9</p>
<blockquote>
<div><ul class="simple">
<li>kafka-clients-0.9.0.1.jar</li>
<li>kafka_2.11-0.9.0.1.jar</li>
<li>metrics-core-2.2.0.jar</li>
<li>zkclient-0.7.jar</li>
<li>zookeeper-3.4.6.jar</li>
</ul>
</div></blockquote>
<p>Kafka 0.10</p>
<blockquote>
<div><ul class="simple">
<li>kafka-clients-0.10.0.1.jar</li>
<li>kafka-2.11-0.10.0.1.jar</li>
<li>metrics-core-2.2.0.jar</li>
<li>zkclient-0.8.jar</li>
<li>zookeeper-3.4.6.jar</li>
</ul>
</div></blockquote>
<p>There is a script in the <tt class="docutils literal"><span class="pre">geomesa-kafka-$KAFKAVERSION_2.11-$VERSION/bin</span></tt> directory
(<tt class="docutils literal"><span class="pre">$GEOMESA_KAFKA_HOME/bin/install-kafka.sh</span></tt>) which will install these
dependencies to a target directory using <tt class="docutils literal"><span class="pre">wget</span></tt> (requires an internet
connection).</p>
<p>Restart GeoServer after the JARs are installed.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2016 Commonwealth Computer Research, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.3.2-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>