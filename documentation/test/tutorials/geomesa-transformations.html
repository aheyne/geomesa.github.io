<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GeoMesa Transformations &mdash; GeoMesa 1.2.0 Manuals</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GeoMesa 1.2.0 Manuals" href="../index.html" />
    <link rel="up" title="GeoMesa 1.2.0 Tutorials" href="index.html" />
    <link rel="next" title="Apache Spark Analysis" href="spark.html" />
    <link rel="prev" title="GeoMesa Raster Support" href="geomesa-raster.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spark.html" title="Apache Spark Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geomesa-raster.html" title="GeoMesa Raster Support"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GeoMesa 1.2.0 Manuals</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">GeoMesa 1.2.0 Tutorials</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">GeoMesa Transformations</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#download-and-build-tutorial-code">Download and Build Tutorial Code</a></li>
<li><a class="reference internal" href="#run-the-tutorial">Run the Tutorial</a></li>
<li><a class="reference internal" href="#looking-closer-at-the-code">Looking Closer at the Code</a></li>
<li><a class="reference internal" href="#sample-code-and-output">Sample Code and Output</a><ul>
<li><a class="reference internal" href="#create-a-basic-query-with-no-projections">Create a basic query with no projections</a></li>
<li><a class="reference internal" href="#create-a-query-with-a-projection-for-two-attributes">Create a query with a projection for two attributes</a></li>
<li><a class="reference internal" href="#create-a-query-with-an-attribute-transformation">Create a query with an attribute transformation</a></li>
<li><a class="reference internal" href="#create-a-query-with-a-derived-attribute">Create a query with a derived attribute</a></li>
<li><a class="reference internal" href="#create-a-query-with-a-geometric-transformation">Create a query with a geometric transformation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="geomesa-raster.html"
                        title="previous chapter">GeoMesa Raster Support</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="spark.html"
                        title="next chapter">Apache Spark Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/geomesa-transformations.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="geomesa-transformations">
<h1>GeoMesa Transformations<a class="headerlink" href="#geomesa-transformations" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will show you how to write custom Java code using GeoMesa to do the following:</p>
<ol class="arabic simple">
<li>Query previously-ingested data.</li>
<li>Apply <a class="reference external" href="http://en.wikipedia.org/wiki/Projection_%28relational_algebra%29">relational
projections</a>
to your query results.</li>
<li>Apply transformations to your query results.</li>
</ol>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>GeoMesa allows users to perform <a class="reference external" href="http://en.wikipedia.org/wiki/Projection_%28relational_algebra%29">relational
projections</a>
on query results. We call these &#8220;transformations&#8221; to distinguish them
from the overloaded term &#8220;projection&#8221; which has a different meaning in a
spatial context. These transformations have the following uses and
advantages:</p>
<ol class="arabic simple">
<li>Subset to specified columns - reduces network overhead of returning
results</li>
<li>Rename specified columns - alters the schema of data on the fly</li>
<li>Compute new attributes from one or more original attributes - adds
derived fields to results</li>
</ol>
<p>The transformations are applied in parallel across the cluster thus
making them very fast. They are analogous to the map tasks in a
map-reduce job. Transformations are also extensible; developers can
implement new functions and plug them into the system using standard
mechanisms from <a class="reference external" href="http://www.geotools.org/">GeoTools</a>.</p>
<p><strong>Note:</strong> when this tutorial refers to &#8220;projections&#8221;, it means in the
relational sense - see <a class="reference external" href="http://en.wikipedia.org/wiki/Projection_(relational_algebra)">Projection - Relational
Algebra</a>.
Projection also has <a class="reference external" href="http://en.wikipedia.org/wiki/Projection_(disambiguation)">many other
meanings</a>
in spatial discussions - they are not used in this tutorial. Although
projections can also modify an attribute&#8217;s value, in this tutorial we
will refer to such modifications as &#8220;transformations&#8221; to keep things
clearer.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="callout callout-warning"><div class="highlight-python"><div class="highlight"><pre>&lt;span class=&quot;glyphicon glyphicon-exclamation-sign&quot;&gt;&lt;/span&gt;
You will need access to a Hadoop 2.2 installation as well as an Accumulo |accumulo_version| database.
</pre></div>
</div>
</div><div class="callout callout-warning"><div class="highlight-python"><div class="highlight"><pre>&lt;span class=&quot;glyphicon glyphicon-exclamation-sign&quot;&gt;&lt;/span&gt;
You will need to have ingested GDELT data using GeoMesa. Instructions are available &lt;a href=&quot;/geomesa-gdelt-analysis/&quot;&gt;here&lt;/a&gt;.
</pre></div>
</div>
</div><p>You will also need:</p>
<ul class="simple">
<li>an Accumulo user that has appropriate permissions to query your data,</li>
<li>Java JDK 7,</li>
<li><a class="reference external" href="http://maven.apache.org/">Apache Maven</a> 3.2.2 or better, and</li>
<li>a <a class="reference external" href="http://git-scm.com/">git</a> client.</li>
</ul>
</div>
<div class="section" id="download-and-build-tutorial-code">
<h2>Download and Build Tutorial Code<a class="headerlink" href="#download-and-build-tutorial-code" title="Permalink to this headline">¶</a></h2>
<p>Clone the geomesa project and build it, if you haven&#8217;t already:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ git clone https://github.com/locationtech/geomesa.git
$ cd geomesa
$ mvn clean install
</pre></div>
</div>
<p>This is needed to install the GeoMesa JAR files in your local Maven
repository. For more information see the <a class="reference external" href="/geomesa-quickstart/">GeoMesa Accumulo Quick
Start</a> tutorial.</p>
<p>Clone the GeoMesa tutorials project:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ git clone https://github.com/geomesa/geomesa-tutorials.git
</pre></div>
</div>
<p>The source code for this tutorial is in the <code class="docutils literal"><span class="pre">geomesa-examples-transformations</span></code>
directory:</p>
<blockquote>
<div>$ cd geomesa-tutorials/geomesa-examples-transformations</div></blockquote>
<p>The Maven <code class="docutils literal"><span class="pre">pom.xml</span></code> file contains an explicit list of dependent
libraries that will be bundled together into the final tutorial. You
should confirm that the versions of Accumulo and Hadoop match what you
are running; if it does not match, change the value in the POM.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The only reason these libraries are bundled into the final JAR is that this
is easier for most people to do this than it is to set the classpath
when running the tutorial. If you would rather not bundle these
dependencies, mark them as provided in the POM, and update your
classpath as appropriate.</p>
</div>
<p>From within this directory, run:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ mvn clean install
</pre></div>
</div>
<p>When this is complete, it will have built a JAR file that contains all
of the code you need to run the tutorial in the <code class="docutils literal"><span class="pre">target</span></code> subdirectory.</p>
</div>
<div class="section" id="run-the-tutorial">
<h2>Run the Tutorial<a class="headerlink" href="#run-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>You will need to have ingested some GDELT data using GeoMesa;
instructions are available in the <a class="reference external" href="/geomesa-gdelt-analysis/">GDELT Map-Reduce
tutorial</a>. Ideally data spanning 2013-2014
should be included, as this tutorial follows the previous tutorial in
searching for events in the Ukraine during the recent civil unrest.</p>
<p>On the command line, run:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>java -cp ./target/geomesa-examples-transformations-$VERSION.jar \
   com.example.geomesa.transformations.QueryTutorial \
   -instanceId &lt;instance&gt; \
   -zookeepers &lt;zoos&gt; \
   -user &lt;user&gt; \
   -password &lt;pwd&gt; \
   -tableName &lt;table&gt; \
   -featureName &lt;feature&gt;
</pre></div>
</div>
<p>where you provide the following arguments:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">&lt;instance&gt;</span></code> - the name of your Accumulo instance</li>
<li><code class="docutils literal"><span class="pre">&lt;zoos&gt;</span></code> - comma-separated list of your Zookeeper nodes, e.g.
zoo1:2181,zoo2:2181,zoo3:2181</li>
<li><code class="docutils literal"><span class="pre">&lt;user&gt;</span></code> - the name of an Accumulo user that will execute the
scans, e.g. root</li>
<li><code class="docutils literal"><span class="pre">&lt;pwd&gt;</span></code> - the password for the previously-mentioned Accumulo user</li>
<li><code class="docutils literal"><span class="pre">&lt;table&gt;</span></code> - the name of the Accumulo table that has the GeoMesa
GDELT dataset, e.g. &#8220;gdelt&#8221; if you followed the GDELT tutorial</li>
<li><code class="docutils literal"><span class="pre">&lt;feature&gt;</span></code> - the feature name used to ingest the GeoMesa GDELT
dataset, e.g. &#8220;event&#8221; if you followed the GDELT tutorial</li>
</ul>
<p>You should see several queries run and the results printed out to your
console.</p>
</div>
<div class="section" id="looking-closer-at-the-code">
<h2>Looking Closer at the Code<a class="headerlink" href="#looking-closer-at-the-code" title="Permalink to this headline">¶</a></h2>
<p>The code for querying and projections is available in the class
<code class="docutils literal"><span class="pre">QueryTutorial</span></code>. The source code is meant to be
accessible, but here is a high-level breakdown of the relevant methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">basicQuery</span></code> - executes a base filter without any further options.
All attributes are returned in the data set.</li>
<li><code class="docutils literal"><span class="pre">basicProjectionQuery</span></code> - executes a base filter but specifies a
subset of attributes to return.</li>
<li><code class="docutils literal"><span class="pre">basicTransformationQuery</span></code> - executes a base filter and transforms
one of the attributes that is returned.</li>
<li><code class="docutils literal"><span class="pre">renamedTransformationQuery</span></code> - executes a base filter and
transforms one of the attributes, returning it in a separate derived
attribute.</li>
<li><code class="docutils literal"><span class="pre">mutliFieldTransformationQuery</span></code> - executes a base filter and
transforms two attributes into a single derived attributes.</li>
<li><code class="docutils literal"><span class="pre">geometricTransformationQuery</span></code> - executes a base filter and
transforms the geometry returned from a point into a polygon by
buffering it.</li>
</ul>
<p>Additional transformation functions are listed
<a class="reference external" href="http://docs.geotools.org/latest/userguide/library/main/filter.html">here</a>.
<em>Please note that currently not all functions are supported by GeoMesa.</em></p>
<p>Additionally, there are two helper classes included in the tutorial:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">GdeltFeature</span></code> - Contains the properties
(attributes) available in the GDELT data set.</li>
<li><code class="docutils literal"><span class="pre">SetupUtil</span></code> - Handles reading command-line
arguments.</li>
</ul>
</div>
<div class="section" id="sample-code-and-output">
<h2>Sample Code and Output<a class="headerlink" href="#sample-code-and-output" title="Permalink to this headline">¶</a></h2>
<p>The following code snippets show the basic aspects of creating queries
for GeoMesa.</p>
<style>
  div.output-scroll {
    margin-left: 30px;
    overflow: auto;
    width: 90%;
  }
  table.output {
    border: 2px inset white;
  }
  table.output td {
    font-size: 12px;
  }
  table.output th, table.output td {
    padding: 5px 10px;
    white-space: nowrap;
  }
  table.output tr.odd th, table.output tr.odd td {
    background-color: gray;
    color: black;
  }
</style><div class="section" id="create-a-basic-query-with-no-projections">
<h3>Create a basic query with no projections<a class="headerlink" href="#create-a-basic-query-with-no-projections" title="Permalink to this headline">¶</a></h3>
<p>This query does not use any projections or transformations. Note that
all attributes are returned in the results.</p>
<div class="code java highlight-python"><div class="highlight"><pre>Query query = new Query(simpleFeatureTypeName, cqlFilter);
</pre></div>
</div>
<p><strong>Output</strong></p>
<div class="output-scroll"><table class="output"><tr><th><p>Result</p>
</th><th><p>GLOBALEVENTID</p>
</th><th><p>SQLDATE</p>
</th><th><p>MonthYear</p>
</th><th><p>Year</p>
</th><th><p>FractionDate</p>
</th><th><p>Actor1Code</p>
</th><th><p>Actor1Name</p>
</th><th><p>Actor1CountryCode</p>
</th><th><p>Actor1KnownGroupCode</p>
</th><th><p>Actor1EthnicCode</p>
</th><th><p>Actor1Religion1Code</p>
</th><th><p>Actor1Religion2Code</p>
</th><th><p>Actor1Type1Code</p>
</th><th><p>Actor1Type2Code</p>
</th><th><p>Actor1Type3Code</p>
</th><th><p>Actor2Code</p>
</th><th><p>Actor2Name</p>
</th><th><p>Actor2CountryCode</p>
</th><th><p>Actor2KnownGroupCode</p>
</th><th><p>Actor2EthnicCode</p>
</th><th><p>Actor2Religion1Code</p>
</th><th><p>Actor2Religion2Code</p>
</th><th><p>Actor2Type1Code</p>
</th><th><p>Actor2Type2Code</p>
</th><th><p>Actor2Type3Code</p>
</th><th><p>IsRootEvent</p>
</th><th><p>EventCode</p>
</th><th><p>EventBaseCode</p>
</th><th><p>EventRootCode</p>
</th><th><p>QuadClass</p>
</th><th><p>GoldsteinScale</p>
</th><th><p>NumMentions</p>
</th><th><p>NumSources</p>
</th><th><p>NumArticles</p>
</th><th><p>AvgTone</p>
</th><th><p>Actor1Geo_Type</p>
</th><th><p>Actor1Geo_FullName</p>
</th><th><p>Actor1Geo_CountryCode</p>
</th><th><p>Actor1Geo_ADM1Code</p>
</th><th><p>Actor1Geo_Lat</p>
</th><th><p>Actor1Geo_Long</p>
</th><th><p>Actor1Geo_FeatureID</p>
</th><th><p>Actor2Geo_Type</p>
</th><th><p>Actor2Geo_FullName</p>
</th><th><p>Actor2Geo_CountryCode</p>
</th><th><p>Actor2Geo_ADM1Code</p>
</th><th><p>Actor2Geo_Lat</p>
</th><th><p>Actor2Geo_Long</p>
</th><th><p>Actor2Geo_FeatureID</p>
</th><th><p>ActionGeo_Type</p>
</th><th><p>ActionGeo_FullName</p>
</th><th><p>ActionGeo_CountryCode</p>
</th><th><p>ActionGeo_ADM1Code</p>
</th><th><p>ActionGeo_Lat</p>
</th><th><p>ActionGeo_Long</p>
</th><th><p>ActionGeo_FeatureID</p>
</th><th><p>DATEADDED</p>
</th><th><p>geom</p>
</th></tr><tr class="odd"><td><p>1</p>
</td><td><p>284464526</p>
</td><td><p>Sun Feb 02 00:00:00 EST 2014</p>
</td><td><p>201402</p>
</td><td><p>2014</p>
</td><td><p>2014.0876</p>
</td><td><p>USA</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>USAGOV</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td><p>GOV</p>
</td><td></td><td></td><td><p>0</p>
</td><td><p>010</p>
</td><td><p>010</p>
</td><td><p>01</p>
</td><td><p>1</p>
</td><td><p>0.0</p>
</td><td><p>2</p>
</td><td><p>1</p>
</td><td><p>2</p>
</td><td><p>2.6362038</p>
</td><td><p>4</p>
</td><td><p>Kyiv, Kyyiv, Misto, Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP12</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>1</p>
</td><td><p>United States</p>
</td><td><p>US</p>
</td><td><p>US</p>
</td><td><p>38.0</p>
</td><td><p>-97.0</p>
</td><td><p>null</p>
</td><td><p>1</p>
</td><td><p>United States</p>
</td><td><p>US</p>
</td><td><p>US</p>
</td><td><p>38.0</p>
</td><td><p>-97.0</p>
</td><td><p>null</p>
</td><td><p>20140202</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr><tr><td><p>2</p>
</td><td><p>284466704</p>
</td><td><p>Sun Feb 02 00:00:00 EST 2014</p>
</td><td><p>201402</p>
</td><td><p>2014</p>
</td><td><p>2014.0876</p>
</td><td><p>USAGOV</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td><p>GOV</p>
</td><td></td><td></td><td><p>USA</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>1</p>
</td><td><p>036</p>
</td><td><p>036</p>
</td><td><p>03</p>
</td><td><p>1</p>
</td><td><p>4.0</p>
</td><td><p>4</p>
</td><td><p>1</p>
</td><td><p>4</p>
</td><td><p>1.5810276</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>20140202</p>
</td><td><p>POINT (32 49)</p>
</td></tr><tr class="odd"><td><p>3</p>
</td><td><p>284427971</p>
</td><td><p>Sun Feb 02 00:00:00 EST 2014</p>
</td><td><p>201402</p>
</td><td><p>2014</p>
</td><td><p>2014.0876</p>
</td><td><p>IGOUNO</p>
</td><td><p>UNITED NATIONS</p>
</td><td></td><td><p>UNO</p>
</td><td></td><td></td><td></td><td><p>IGO</p>
</td><td></td><td></td><td><p>USA</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>0</p>
</td><td><p>012</p>
</td><td><p>012</p>
</td><td><p>01</p>
</td><td><p>1</p>
</td><td><p>-0.4</p>
</td><td><p>27</p>
</td><td><p>3</p>
</td><td><p>27</p>
</td><td><p>1.0064903</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>20140202</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr><tr><td><p>4</p>
</td><td><p>284466607</p>
</td><td><p>Sun Feb 02 00:00:00 EST 2014</p>
</td><td><p>201402</p>
</td><td><p>2014</p>
</td><td><p>2014.0876</p>
</td><td><p>USAGOV</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td><p>GOV</p>
</td><td></td><td></td><td><p>UKR</p>
</td><td><p>UKRAINE</p>
</td><td><p>UKR</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>1</p>
</td><td><p>100</p>
</td><td><p>100</p>
</td><td><p>10</p>
</td><td><p>3</p>
</td><td><p>-5.0</p>
</td><td><p>2</p>
</td><td><p>1</p>
</td><td><p>2</p>
</td><td><p>7.826087</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>1</p>
</td><td><p>Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP</p>
</td><td><p>49.0</p>
</td><td><p>32.0</p>
</td><td><p>null</p>
</td><td><p>20140202</p>
</td><td><p>POINT (32 49)</p>
</td></tr><tr class="odd"><td><p>5</p>
</td><td><p>284464187</p>
</td><td><p>Sun Feb 02 00:00:00 EST 2014</p>
</td><td><p>201402</p>
</td><td><p>2014</p>
</td><td><p>2014.0876</p>
</td><td><p>USA</p>
</td><td><p>UNITED STATES</p>
</td><td><p>USA</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>UKR</p>
</td><td><p>UKRAINE</p>
</td><td><p>UKR</p>
</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><p>0</p>
</td><td><p>111</p>
</td><td><p>111</p>
</td><td><p>11</p>
</td><td><p>3</p>
</td><td><p>-2.0</p>
</td><td><p>5</p>
</td><td><p>1</p>
</td><td><p>5</p>
</td><td><p>1.4492754</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>4</p>
</td><td><p>Kiev, Ukraine (general), Ukraine</p>
</td><td><p>UP</p>
</td><td><p>UP00</p>
</td><td><p>50.4333</p>
</td><td><p>30.5167</p>
</td><td><p>-1044367</p>
</td><td><p>20140202</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr></table></div></div>
<div class="section" id="create-a-query-with-a-projection-for-two-attributes">
<h3>Create a query with a projection for two attributes<a class="headerlink" href="#create-a-query-with-a-projection-for-two-attributes" title="Permalink to this headline">¶</a></h3>
<p>This query uses a projection to only return the &#8216;Actor1Name&#8217; and &#8216;geom&#8217;
attributes.</p>
<div class="code java highlight-python"><div class="highlight"><pre>String[] properties = new String[] {&quot;Actor1Name&quot;, &quot;geom&quot;};
Query query = new Query(simpleFeatureTypeName, cqlFilter, properties);
</pre></div>
</div>
<p><strong>Output</strong></p>
<div class="output-scroll"><table class="output"><tr><th><p>Result</p>
</th><th><p>Actor1Name</p>
</th><th><p>geom</p>
</th></tr><tr class="odd"><td><p>1</p>
</td><td><p>UNITED STATES</p>
</td><td><p>POINT (32 49)</p>
</td></tr><tr><td><p>2</p>
</td><td><p>UNITED STATES</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr><tr class="odd"><td><p>3</p>
</td><td><p>UNITED STATES</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr><tr><td><p>4</p>
</td><td><p>UNITED STATES</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr><tr class="odd"><td><p>5</p>
</td><td><p>UNITED STATES</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td></tr></table></div></div>
<div class="section" id="create-a-query-with-an-attribute-transformation">
<h3>Create a query with an attribute transformation<a class="headerlink" href="#create-a-query-with-an-attribute-transformation" title="Permalink to this headline">¶</a></h3>
<p>This query performs a transformation on the &#8216;Actor1Name&#8217; attribute, to
print it in a more user-friendly format.</p>
<div class="code java highlight-python"><div class="highlight"><pre>String[] properties = new String[] {&quot;Actor1Name=strCapitalize(Actor1Name)&quot;, &quot;geom&quot;};
Query query = new Query(simpleFeatureTypeName, cqlFilter, properties);
</pre></div>
</div>
<p><strong>Output</strong></p>
<div class="output-scroll"><table class="output"><tr><th><p>Result</p>
</th><th><p>geom</p>
</th><th><p>Actor1Name</p>
</th></tr><tr class="odd"><td><p>1</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>United States</p>
</td></tr><tr><td><p>2</p>
</td><td><p>POINT (32 49)</p>
</td><td><p>United States</p>
</td></tr><tr class="odd"><td><p>3</p>
</td><td><p>POINT (32 49)</p>
</td><td><p>United States</p>
</td></tr><tr><td><p>4</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>United States</p>
</td></tr><tr class="odd"><td><p>5</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>United States</p>
</td></tr></table></div></div>
<div class="section" id="create-a-query-with-a-derived-attribute">
<h3>Create a query with a derived attribute<a class="headerlink" href="#create-a-query-with-a-derived-attribute" title="Permalink to this headline">¶</a></h3>
<p>This query creates a new attribute called &#8216;derived&#8217; based off a join of
the &#8216;Actor1Name&#8217; and &#8216;Actor1Geo_FullName&#8217; attribute. This could be used
to show the actor and location of the event, for example.</p>
<div class="code java highlight-python"><div class="highlight"><pre>String[] properties = new String[] {&quot;derived=strConcat(Actor1Name,strConcat(&#39; - &#39;,Actor1Geo_FullName)),geom&quot;};
Query query = new Query(simpleFeatureTypeName, cqlFilter, properties);
</pre></div>
</div>
<p><strong>Output</strong></p>
<div class="output-scroll"><table class="output"><tr><th><p>Result</p>
</th><th><p>geom</p>
</th><th><p>derived</p>
</th></tr><tr class="odd"><td><p>1</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>UNITED STATES - Kyiv, Kyyiv, Misto, Ukraine</p>
</td></tr><tr><td><p>2</p>
</td><td><p>POINT (32 49)</p>
</td><td><p>UNITED STATES - Ukraine</p>
</td></tr><tr class="odd"><td><p>3</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>UNITED STATES - Kiev, Ukraine (general), Ukraine</p>
</td></tr><tr><td><p>4</p>
</td><td><p>POINT (32 49)</p>
</td><td><p>UNITED STATES - Ukraine</p>
</td></tr><tr class="odd"><td><p>5</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>UNITED NATIONS - Kiev, Ukraine (general), Ukraine</p>
</td></tr></table></div></div>
<div class="section" id="create-a-query-with-a-geometric-transformation">
<h3>Create a query with a geometric transformation<a class="headerlink" href="#create-a-query-with-a-geometric-transformation" title="Permalink to this headline">¶</a></h3>
<p>This query performs a geometric transformation on the points returned,
buffering them by a fixed amount. This could be used to estimate an area
of impact around a particular event, for example.</p>
<div class="code java highlight-python"><div class="highlight"><pre>String[] properties = new String[] {&quot;geom,derived=buffer(geom, 2)&quot;};
Query query = new Query(simpleFeatureTypeName, cqlFilter, properties);
</pre></div>
</div>
<p><strong>Output</strong></p>
<div class="output-scroll"><table class="output"><tr><th><p>Result</p>
</th><th><p>geom</p>
</th><th><p>derived</p>
</th></tr><tr class="odd"><td><p>1</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>POLYGON ((32.5167 50.4333, 32.478270560806465 50.04311935596775,
32.36445906502257 49.66793313526982, 32.17963922460509 49.3221595339608,
31.930913562373096 49.01908643762691, 31.627840466039206
48.77036077539491, 31.28206686473018 48.58554093497743,
30.906880644032256 48.47172943919354, 30.5167 48.4333,
30.126519355967744 48.47172943919354, 29.75133313526982
48.58554093497743, 29.405559533960798 48.77036077539491,
29.102486437626904 49.01908643762691, 28.85376077539491
49.3221595339608, 28.668940934977428 49.66793313526983,
28.55512943919354 50.04311935596775, 28.5167 50.4333, 28.55512943919354
50.82348064403226, 28.668940934977428 51.198666864730185,
28.85376077539491 51.54444046603921, 29.102486437626908
51.8475135623731, 29.405559533960798 52.09623922460509,
29.751333135269824 52.281059065022575, 30.126519355967748
52.39487056080647, 30.516700000000004 52.4333, 30.906880644032263
52.39487056080646, 31.282066864730186 52.281059065022575,
31.62784046603921 52.09623922460509, 31.9309135623731
51.847513562373095, 32.1796392246051 51.5444404660392, 32.36445906502258
51.19866686473018, 32.478270560806465 50.82348064403225, 32.5167
50.4333))</p>
</td></tr><tr><td><p>2</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>POLYGON ((32.5167 50.4333, 32.478270560806465 50.04311935596775,
32.36445906502257 49.66793313526982, 32.17963922460509 49.3221595339608,
31.930913562373096 49.01908643762691, 31.627840466039206
48.77036077539491, 31.28206686473018 48.58554093497743,
30.906880644032256 48.47172943919354, 30.5167 48.4333,
30.126519355967744 48.47172943919354, 29.75133313526982
48.58554093497743, 29.405559533960798 48.77036077539491,
29.102486437626904 49.01908643762691, 28.85376077539491
49.3221595339608, 28.668940934977428 49.66793313526983,
28.55512943919354 50.04311935596775, 28.5167 50.4333, 28.55512943919354
50.82348064403226, 28.668940934977428 51.198666864730185,
28.85376077539491 51.54444046603921, 29.102486437626908
51.8475135623731, 29.405559533960798 52.09623922460509,
29.751333135269824 52.281059065022575, 30.126519355967748
52.39487056080647, 30.516700000000004 52.4333, 30.906880644032263
52.39487056080646, 31.282066864730186 52.281059065022575,
31.62784046603921 52.09623922460509, 31.9309135623731
51.847513562373095, 32.1796392246051 51.5444404660392, 32.36445906502258
51.19866686473018, 32.478270560806465 50.82348064403225, 32.5167
50.4333))</p>
</td></tr><tr class="odd"><td><p>3</p>
</td><td><p>POINT (32 49)</p>
</td><td><p>POLYGON ((34 49, 33.961570560806464 48.609819355967744,
33.84775906502257 48.23463313526982, 33.66293922460509 47.8888595339608,
33.41421356237309 47.58578643762691, 33.1111404660392 47.33706077539491,
32.76536686473018 47.15224093497743, 32.390180644032256
47.038429439193536, 32 47, 31.609819355967744 47.038429439193536,
31.23463313526982 47.15224093497743, 30.888859533960797
47.33706077539491, 30.585786437626904 47.58578643762691,
30.33706077539491 47.8888595339608, 30.152240934977428
48.234633135269824, 30.03842943919354 48.609819355967744, 30 49,
30.03842943919354 49.390180644032256, 30.152240934977428
49.76536686473018, 30.33706077539491 50.11114046603921,
30.585786437626908 50.4142135623731, 30.888859533960797
50.66293922460509, 31.234633135269824 50.84775906502257,
31.609819355967748 50.961570560806464, 32.00000000000001 51,
32.39018064403226 50.96157056080646, 32.76536686473018
50.84775906502257, 33.11114046603921 50.66293922460509, 33.4142135623731
50.41421356237309, 33.6629392246051 50.111140466039195,
33.84775906502258 49.765366864730176, 33.961570560806464
49.39018064403225, 34 49))</p>
</td></tr><tr><td><p>4</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>POLYGON ((32.5167 50.4333, 32.478270560806465 50.04311935596775,
32.36445906502257 49.66793313526982, 32.17963922460509 49.3221595339608,
31.930913562373096 49.01908643762691, 31.627840466039206
48.77036077539491, 31.28206686473018 48.58554093497743,
30.906880644032256 48.47172943919354, 30.5167 48.4333,
30.126519355967744 48.47172943919354, 29.75133313526982
48.58554093497743, 29.405559533960798 48.77036077539491,
29.102486437626904 49.01908643762691, 28.85376077539491
49.3221595339608, 28.668940934977428 49.66793313526983,
28.55512943919354 50.04311935596775, 28.5167 50.4333, 28.55512943919354
50.82348064403226, 28.668940934977428 51.198666864730185,
28.85376077539491 51.54444046603921, 29.102486437626908
51.8475135623731, 29.405559533960798 52.09623922460509,
29.751333135269824 52.281059065022575, 30.126519355967748
52.39487056080647, 30.516700000000004 52.4333, 30.906880644032263
52.39487056080646, 31.282066864730186 52.281059065022575,
31.62784046603921 52.09623922460509, 31.9309135623731
51.847513562373095, 32.1796392246051 51.5444404660392, 32.36445906502258
51.19866686473018, 32.478270560806465 50.82348064403225, 32.5167
50.4333))</p>
</td></tr><tr class="odd"><td><p>5</p>
</td><td><p>POINT (30.5167 50.4333)</p>
</td><td><p>POLYGON ((32.5167 50.4333, 32.478270560806465 50.04311935596775,
32.36445906502257 49.66793313526982, 32.17963922460509 49.3221595339608,
31.930913562373096 49.01908643762691, 31.627840466039206
48.77036077539491, 31.28206686473018 48.58554093497743,
30.906880644032256 48.47172943919354, 30.5167 48.4333,
30.126519355967744 48.47172943919354, 29.75133313526982
48.58554093497743, 29.405559533960798 48.77036077539491,
29.102486437626904 49.01908643762691, 28.85376077539491
49.3221595339608, 28.668940934977428 49.66793313526983,
28.55512943919354 50.04311935596775, 28.5167 50.4333, 28.55512943919354
50.82348064403226, 28.668940934977428 51.198666864730185,
28.85376077539491 51.54444046603921, 29.102486437626908
51.8475135623731, 29.405559533960798 52.09623922460509,
29.751333135269824 52.281059065022575, 30.126519355967748
52.39487056080647, 30.516700000000004 52.4333, 30.906880644032263
52.39487056080646, 31.282066864730186 52.281059065022575,
31.62784046603921 52.09623922460509, 31.9309135623731
51.847513562373095, 32.1796392246051 51.5444404660392, 32.36445906502258
51.19866686473018, 32.478270560806465 50.82348064403225, 32.5167
50.4333))</p>
</td></tr></table></div></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spark.html" title="Apache Spark Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="geomesa-raster.html" title="GeoMesa Raster Support"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GeoMesa 1.2.0 Manuals</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >GeoMesa 1.2.0 Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, GeoMesa.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>