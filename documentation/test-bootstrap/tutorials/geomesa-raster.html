<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GeoMesa Raster Support &mdash; GeoMesa 1.2.0 Manuals</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="GeoMesa 1.2.0 Manuals" href="../index.html" />
    <link rel="up" title="GeoMesa 1.2.0 Tutorials" href="index.html" />
    <link rel="next" title="GeoMesa Transformations" href="geomesa-examples-transformations.html" />
    <link rel="prev" title="Map-Reduce Ingest of GDELT" href="geomesa-examples-gdelt.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          GeoMesa</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">GeoMesa 1.2.0 User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">GeoMesa 1.2.0 Developer Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">GeoMesa 1.2.0 Tutorials</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">GeoMesa Raster Support</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#ingest">Ingest</a></li>
<li><a class="reference internal" href="#registering-in-geoserver">Registering in GeoServer</a></li>
<li><a class="reference internal" href="#wcs-queries">WCS Queries</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="geomesa-examples-gdelt.html" title="Previous Chapter: Map-Reduce Ingest of GDELT"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Map-Reduce In...</span>
    </a>
  </li>
  <li>
    <a href="geomesa-examples-transformations.html" title="Next Chapter: GeoMesa Transformations"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GeoMesa Trans... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/tutorials/geomesa-raster.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="geomesa-raster-support">
<h1>GeoMesa Raster Support<a class="headerlink" href="#geomesa-raster-support" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will show you how to:</p>
<ol class="arabic simple">
<li>Deploy and use the raster data support in GeoMesa.</li>
<li>Prepare and ingest raster data.</li>
<li>Conduct WMS/WCS queries of raster data.</li>
</ol>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">For Accumulo deployment, you will need access to a Hadoop 2.2 installation as well as an Accumulo 1.5 or 1.6 database.</p>
</div>
<p>Before you begin, you should have these:</p>
<ul class="simple">
<li>basic knowledge of <a class="reference external" href="http://www.geotools.org">GeoTools</a> and
<a class="reference external" href="http://geoserver.org">GeoServer</a>,</li>
<li>access to a <a class="reference external" href="http://geoserver.org/">GeoServer</a> 2.5.2 installation,</li>
<li>an Accumulo user that has both create-table and write permissions,
and</li>
<li>the <a class="reference external" href="http://www.gdal.org/">Geospatial Data Abstraction Library
(GDAL)</a> installed.</li>
</ul>
<p>Before you begin, you should have also set up GeoMesa, using the
instructions in <a class="reference internal" href="../user/installation_and_configuration.html"><em>Installation and Configuration</em></a>.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Raster support in GeoMesa was produced to support image pyramids in
EPSG:4326.</p>
<p>Currently WMS and WCS (version 1.0.0) queries are supported via the
GeoServer plugin.</p>
</div>
<div class="section" id="ingest">
<h2>Ingest<a class="headerlink" href="#ingest" title="Permalink to this headline">¶</a></h2>
<p>First, download and extract the example data set <a class="reference external" href="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/raster/NE2_HR_LC_SR_W_DR.zip">Natural Earth 2 with
Shaded Relief, Water, and
Drainages</a>.
To ingest the raster image into GeoMesa, you must first produce an image
pyramid from this file by using <code class="docutils literal"><span class="pre">gdal_retile.py</span></code>. For an explanation
of the parameters used below, see the <a class="reference external" href="http://www.gdal.org/gdal_retile.html">gdal_retile
documentation</a>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gdal_retile.py -v -pyramidOnly -r lanczos -levels <span class="m">4</span> -ps <span class="m">675</span> <span class="m">675</span> -targetDir ./ NE2_HR_LC_SR_W_DR.tif
</pre></div>
</div>
<p>Once the image pyramid has been prepared, ingest the tiles using the
GeoMesa command line tools. To do this you will first need to follow the
tools deployment instructions in <a class="reference internal" href="../user/installation_and_configuration.html"><em>Installation and Configuration</em></a>.
Once the GeoMesa tools have been deployed you will be able to ingest the prepared pyramid:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>geomesa ingestraster -u username -p password -t natearth -f <span class="s2">&quot;./some/path/to/pyramid/level_1/&quot;</span> -fmt geotiff
</pre></div>
</div>
<p>The ingest needs to be repeated per level of the pyramid generated by
GDAL. Keep the table name (in this case &#8220;natearth&#8221;) the same between
runs of the ingest. Once this process is complete you will need to
register the table into a GeoServer coverage store of the type &#8220;GeoMesa
Coverage Format&#8221;.</p>
<p>When attempting to ingest your own rasters, tiles should be on the order
of 128x128 to 1024x1024 pixels.</p>
</div>
<div class="section" id="registering-in-geoserver">
<h2>Registering in GeoServer<a class="headerlink" href="#registering-in-geoserver" title="Permalink to this headline">¶</a></h2>
<p>To view the ingested pyramid via WMS and WCS you must register the new
table in a &#8220;GeoMesa Coverage Format&#8221; store in the GeoServer UI. Login to
your GeoServer and follow these steps:</p>
<ol class="arabic simple">
<li>Add a new datastore to GeoServer by navigating to the Stores page and
then click &#8220;Add new Store&#8221;.</li>
<li>Click the &#8220;GeoMesa Coverage Format&#8221; as an option under &#8220;Raster Data
Sources&#8221;</li>
<li>Fill in the fields as appropriate to your Accumulo and Zookeeper
configurations. The &#8220;tableName&#8221; field must match the name of the
table we ingested the demo data to.</li>
</ol>
<p><img alt="&quot;GeoMesa Coverage Format configuration example&quot;" src="../_images/geomesa_coverage_format_1.png" /></p>
<ol class="arabic simple" start="4">
<li>Click &#8220;Save&#8221;, then click &#8220;Publish&#8221; when GeoServer prompts you to add
the layer.</li>
<li>Once you have completed registering the layer, you should be able to
use the open layers preview for the layer to view the raster via WMS.</li>
</ol>
<p><img alt="&quot;GeoMesa Raster WMS example&quot;" src="../_images/geomesa_raster_wms.png" /></p>
</div>
<div class="section" id="wcs-queries">
<h2>WCS Queries<a class="headerlink" href="#wcs-queries" title="Permalink to this headline">¶</a></h2>
<p>WCS version 1.0.0 queries are fairly similar to WMS queries. Try running
the following WCS query on the Natural Earth test data table by first
modifying and running the following url as needed for your GeoServer
configuration.</p>
<div class="highlight-html"><div class="highlight"><pre>http://localhost:8080/geoserver/workspace?service=WCS&amp;version=1.0.0&amp;request=GetCoverage&amp;coverage=workspace:natearth&amp;bbox=-180.0,-90.0,180.0,90.0&amp;width=660&amp;height=330&amp;crs=EPSG:4326&amp;format=geotiff
</pre></div>
</div>
<p>This will return a GeoTIFF of the extension requested. As in the WMS
open layers viewer, the tiles are concatenated together into a mosaic.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013-2016 Commonwealth Computer Research, Inc..<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>